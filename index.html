<!DOCTYPE html>

<html lang="id">
<head>
<head>
<meta charset="utf-8"/>
<title>Absensi Chong De Youth</title>
<!-- Open Graph Meta -->
<meta content="Absensi Digital - Chong De Youth Medan" property="og:title"/>
<meta content="Form absensi digital untuk Chong De Youth Medan." property="og:description"/>
<meta content="https://ricko333.github.io/ChongDeYouth/images/chongdeyouth.png" property="og:image"/>
<meta content="https://ricko333.github.io/ChongDeYouth/" property="og:url"/>
<meta content="website" property="og:type"/>
</head>
</head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Absensi Digital - Chong De Youth</title>


<script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&amp;family=Luckiest+Guy&amp;family=Bangers&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
        body {
            font-family: 'Quicksand', sans-serif;
            background-color: #f0f9ff;
        }
        .title-text {
            font-family: 'Luckiest Guy', cursive;
            color: #fbbf24;
            text-shadow: 2px 2px 0 #000, -2px -2px 0 #000, 2px -2px 0 #000, -2px 2px 0 #000;
            letter-spacing: 1px;
        }
        .dashboard-title {
            font-family: 'Bangers', cursive;
            color: #fbbf24;
            text-shadow: 2px 2px 0 #000, -2px -2px 0 #000, 2px -2px 0 #000, -2px 2px 0 #000;
            letter-spacing: 2px;
        }
        .attendance-grid {
            display: grid;
            grid-template-columns: minmax(200px, 1.5fr) repeat(4, 1fr);
        }
        .attendance-header {
            background-color: #3b82f6;
            color: white;
            padding: 12px;
            font-weight: 600;
            text-align: center;
            border-right: 1px solid rgba(255, 255, 255, 0.2);
        }
        .attendance-header:first-child {
            text-align: left;
            padding-left: 20px;
            border-top-left-radius: 8px;
        }
        .attendance-header:last-child {
            border-right: none;
            border-top-right-radius: 8px;
        }
        .attendance-cell {
            padding: 12px;
            border-bottom: 1px solid #e5e7eb;
            border-right: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
        }
        .attendance-cell:first-child {
            border-left: 1px solid #e5e7eb;
        }
        .attendance-row:nth-child(even) .attendance-cell {
            background-color: #f9fafb;
        }
        .attendance-row:hover .attendance-cell {
            background-color: #f3f4f6;
        }
        .status-badge {
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .status-badge:hover {
            transform: scale(1.05);
        }
        .status-present {
            background-color: #d1fae5;
            color: #065f46;
        }
        .status-absent {
            background-color: #fee2e2;
            color: #b91c1c;
        }
        .status-excused {
            background-color: #e0e7ff;
            color: #3730a3;
        }
        .logo-preview {
            width: 100px;
            height: 100px;
            object-fit: contain;
            border-radius: 10px;
        }
        .animate-float {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .date-header {
            position: relative;
        }
        .date-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background-color: #fcd34d;
            border-radius: 3px;
        }
        .calendar-day {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
        }
        .calendar-day:hover {
            transform: scale(1.1);
        }
        .event-day {
            position: relative;
        }
        .event-day::after {
            content: '';
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background-color: #3b82f6;
        }
        .dashboard-card {
            transition: all 0.3s ease;
            border-radius: 16px;
            overflow: hidden;
        }
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .progress-ring {
            transform: rotate(-90deg);
        }
        .progress-ring__circle {
            stroke-dasharray: 283;
            transition: stroke-dashoffset 0.5s ease;
        }
        .mini-bar {
            height: 40px;
            border-radius: 4px;
            overflow: hidden;
            background-color: #e5e7eb;
        }
        .mini-bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 1s ease-in-out;
        }
        .status-card {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .status-card:hover {
            transform: translateY(-5px);
        }
        .file-input-label {
            display: inline-block;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 4px;
            background-color: #e5e7eb;
            transition: background-color 0.3s;
        }
        .file-input-label:hover {
            background-color: #d1d5db;
        }
        .file-input {
            width: 0.1px;
            height: 0.1px;
            opacity: 0;
            overflow: hidden;
            position: absolute;
            z-index: -1;
        }
        .gender-radio:checked + label {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
            appearance: none;
        }
        /* Modal animation */
        .modal-enter {
            animation: modalFadeIn 0.3s ease-out forwards;
        }
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Calendar styles */
        .calendar {
            width: 100%;
            border-collapse: separate;
            border-spacing: 2px;
        }
        .calendar th {
            height: 30px;
            text-align: center;
            font-weight: 600;
            color: #4b5563;
        }
        .calendar td {
            width: 14.28%;
            height: 40px;
            text-align: center;
            vertical-align: middle;
            border-radius: 8px;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }
        .calendar td:hover {
            background-color: #e5e7eb;
        }
        .calendar .today {
            background-color: #3b82f6;
            color: white;
            font-weight: 600;
        }
        .calendar .other-month {
            color: #9ca3af;
        }
        .calendar .has-event {
            position: relative;
        }
        .calendar .has-event::after {
            content: '';
            position: absolute;
            bottom: 4px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background-color: #3b82f6;
        }
        .calendar .today.has-event::after {
            background-color: white;
        }
    </style>
<body>
<!-- Attendance Page -->
<div id="attendance-page">
<div class="container mx-auto px-4 py-8 max-w-7xl">
<!-- Header with Navigation -->
<div class="flex flex-col md:flex-row justify-between items-center mb-8">
<div class="flex items-center mb-4 md:mb-0">
<div class="mr-4 w-16 h-16 flex items-center justify-center" id="logo-container">
<img alt="Logo Chong De Youth" class="hidden max-w-full max-h-full" id="logo-preview"/>
<svg class="h-20 w-20 text-blue-700" fill="none" id="default-logo" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
<div>
<h1 class="text-3xl md:text-4xl font-bold title-text">ABSENSI</h1>
<h2 class="text-2xl md:text-3xl font-bold title-text">CHONG DE YOUTH</h2>
</div>
</div>
<div class="flex space-x-3">
<button class="flex items-center bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded-lg transition-colors" id="go-to-dashboard">
<svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
                        Dashboard
                    </button>
<button class="flex items-center bg-green-100 hover:bg-green-200 text-green-700 px-4 py-2 rounded-lg transition-colors" id="export-btn">
<svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
                        Export
                    </button>
<button class="flex items-center bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors" id="add-attendance-btn">
<svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 6v6m0 0v6m0-6h6m-6 0H6" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
                        Tambah Absensi
                    </button>
</div>
</div>
<!-- Filter and Search Section -->
<div class="bg-white rounded-xl shadow-md p-6 mb-6">
<div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
<div class="flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-4">
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="meeting-date">Tanggal</label>
<input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="meeting-date" type="date"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="activity-select">Aktivitas</label>
<select class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="activity-select">
<option disabled="" selected="" value="">Pilih aktivitas</option>
<option value="Ngobras">Ngobras</option>
<option value="Aktivitas Outdoor">Aktivitas Outdoor</option>
<option value="Sidang Dharma">Sidang Dharma</option>
<option value="Kelas Dharma">Kelas Dharma</option>
</select>
</div>
</div>
</div>
</div>
<!-- Attendance Summary Cards -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
<!-- Total Anggota -->
<div class="status-card bg-gradient-to-br from-blue-400 to-blue-500 rounded-xl p-6 text-white shadow-lg" id="total-members-card">
<div class="flex justify-between items-start">
<div>
<p class="text-blue-100 text-sm font-medium">Total Anggota</p>
<h2 class="text-3xl font-bold mt-1">0</h2>
<p class="text-blue-100 text-xs mt-2">Terdaftar dalam sistem</p>
</div>
<div class="bg-white/20 p-3 rounded-lg">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
</div>
<!-- Hadir -->
<div class="status-card bg-gradient-to-br from-green-400 to-green-500 rounded-xl p-6 text-white shadow-lg" id="present-card">
<div class="flex justify-between items-start">
<div>
<p class="text-green-100 text-sm font-medium">Hadir</p>
<h2 class="text-3xl font-bold mt-1">0</h2>
<p class="text-green-100 text-xs mt-2">0% dari total anggota</p>
</div>
<div class="bg-white/20 p-3 rounded-lg">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M5 13l4 4L19 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
</div>
<!-- Tidak Hadir -->
<div class="status-card bg-gradient-to-br from-red-400 to-red-500 rounded-xl p-6 text-white shadow-lg" id="absent-card">
<div class="flex justify-between items-start">
<div>
<p class="text-red-100 text-sm font-medium">Tidak Hadir</p>
<h2 class="text-3xl font-bold mt-1">0</h2>
<p class="text-red-100 text-xs mt-2">0% dari total anggota</p>
</div>
<div class="bg-white/20 p-3 rounded-lg">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
</div>
<!-- Izin -->
<div class="status-card bg-gradient-to-br from-yellow-400 to-yellow-500 rounded-xl p-6 text-white shadow-lg" id="excused-card">
<div class="flex justify-between items-start">
<div>
<p class="text-yellow-100 text-sm font-medium">Izin</p>
<h2 class="text-3xl font-bold mt-1">0</h2>
<p class="text-yellow-100 text-xs mt-2">0% dari total anggota</p>
</div>
<div class="bg-white/20 p-3 rounded-lg">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
</div>
</div>
<!-- Attendance Table -->
<div class="bg-white rounded-xl shadow-md overflow-hidden mb-6">
<div class="p-6 border-b border-gray-200">
<h2 class="text-xl font-semibold text-gray-800">Daftar Kehadiran</h2>
<p class="text-gray-500" id="attendance-date">Tanggal: -</p>
<p class="text-gray-500" id="attendance-activity">Aktivitas: -</p>
</div>
<div class="overflow-x-auto">
<div class="attendance-grid">
<!-- Headers -->
<div class="attendance-header">Daftar Kehadiran</div>
<div class="attendance-header">Kehadiran</div>
<div class="attendance-header">Kehadiran</div>
<div class="attendance-header">Kehadiran</div>
<div class="attendance-header">Kehadiran</div>
<!-- Empty state -->
<div class="attendance-row empty-state">
<div class="attendance-cell col-span-5 py-8 justify-center text-gray-500">
                                Belum ada data absensi. Klik "Tambah Absensi" untuk menambahkan data.
                            </div>
</div>
</div>
</div>
<!-- Pagination -->
<div class="p-6 border-t border-gray-200 flex justify-between items-center">
<div class="text-sm text-gray-500">
                        Menampilkan 0 anggota
                    </div>
<div class="flex space-x-2">
<button class="px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-50 text-gray-500 disabled:opacity-50" disabled="">
<svg class="h-5 w-5" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M15 19l-7-7 7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
<button class="px-3 py-1 border border-gray-300 rounded-md bg-blue-500 text-white">1</button>
<button class="px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-50 text-gray-500 disabled:opacity-50" disabled="">
<svg class="h-5 w-5" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M9 5l7 7-7 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
</div>
</div>
</div>
</div>
<!-- Dashboard Page -->
<div class="hidden" id="dashboard-page">
<div class="container mx-auto px-4 py-8 max-w-7xl">
<!-- Header -->
<div class="flex flex-col md:flex-row justify-between items-center mb-8">
<div class="flex items-center mb-4 md:mb-0">
<div class="mr-4 w-16 h-16 flex items-center justify-center">
<img alt="Logo Chong De Youth" class="hidden max-w-full max-h-full" id="dashboard-logo-preview"/>
<svg class="h-10 w-10 text-blue-700" fill="none" id="dashboard-default-logo" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
<div>
<h1 class="text-3xl md:text-4xl font-bold dashboard-title">DASHBOARD KEHADIRAN</h1>
<h2 class="text-2xl md:text-3xl font-bold dashboard-title">CHONG DE YOUTH</h2>
</div>
</div>
<div class="flex space-x-3">
<button class="flex items-center bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded-lg transition-colors" id="go-to-attendance">
<svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
                        Absensi
                    </button>
</div>
</div>
<!-- Main Content -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
<!-- Left Column -->
<div class="col-span-1 md:col-span-2 space-y-6">
<!-- Stats Cards -->
<div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
<!-- Total Anggota -->
<div class="dashboard-card bg-gradient-to-br from-blue-400 to-blue-500 p-6 text-white shadow-lg">
<div class="flex justify-between items-start">
<div>
<p class="text-blue-100 text-sm font-medium">Total Anggota</p>
<h2 class="text-3xl font-bold mt-1">0</h2>
<p class="text-blue-100 text-xs mt-2">Anggota terdaftar</p>
</div>
<div class="bg-white/20 p-3 rounded-lg">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
</div>
<!-- Kehadiran -->
<div class="dashboard-card bg-gradient-to-br from-green-400 to-green-500 p-6 text-white shadow-lg">
<div class="flex justify-between items-start">
<div>
<p class="text-green-100 text-sm font-medium">Kehadiran</p>
<h2 class="text-3xl font-bold mt-1">0</h2>
<p class="text-green-100 text-xs mt-2">Dari 0 kegiatan</p>
</div>
<div class="bg-white/20 p-3 rounded-lg">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
</div>
<!-- Persentase Kehadiran -->
<div class="dashboard-card bg-gradient-to-br from-yellow-400 to-yellow-500 p-6 text-white shadow-lg">
<div class="flex justify-between items-start">
<div>
<p class="text-yellow-100 text-sm font-medium">Persentase Kehadiran</p>
<h2 class="text-3xl font-bold mt-1">0%</h2>
<p class="text-yellow-100 text-xs mt-2">Rata-rata kehadiran</p>
</div>
<div class="bg-white/20 p-3 rounded-lg">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
</div>
</div>
<!-- Chart Section -->
<div class="bg-white rounded-xl shadow-md p-6">
<div class="flex justify-between items-center mb-6">
<h3 class="text-lg font-semibold text-gray-800">Statistik Kehadiran</h3>
<div class="flex space-x-2">
<button class="px-3 py-1 bg-blue-100 text-blue-600 rounded-full text-sm font-medium">Mingguan</button>
<button class="px-3 py-1 bg-blue-500 text-white rounded-full text-sm font-medium">Bulanan</button>
<button class="px-3 py-1 bg-blue-100 text-blue-600 rounded-full text-sm font-medium">Tahunan</button>
</div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div>
<h4 class="text-center font-medium text-gray-700 mb-4">Distribusi Kehadiran</h4>
<div class="flex justify-center">
<div class="relative w-48 h-48">
<canvas id="attendanceChart"></canvas>
<div class="absolute inset-0 flex items-center justify-center flex-col">
<span class="text-3xl font-bold text-blue-600">0%</span>
<span class="text-sm text-gray-500">Kehadiran</span>
</div>
</div>
</div>
<div class="mt-4 grid grid-cols-2 gap-2">
<div class="flex items-center">
<div class="w-3 h-3 rounded-full bg-blue-500 mr-2"></div>
<span class="text-sm">Hadir (0%)</span>
</div>
<div class="flex items-center">
<div class="w-3 h-3 rounded-full bg-red-500 mr-2"></div>
<span class="text-sm">Tidak Hadir (0%)</span>
</div>
<div class="flex items-center">
<div class="w-3 h-3 rounded-full bg-yellow-500 mr-2"></div>
<span class="text-sm">Izin (0%)</span>
</div>
</div>
</div>
<div>
<h4 class="text-center font-medium text-gray-700 mb-4">Data Kehadiran</h4>
<div class="flex items-center justify-center h-48 bg-gray-50 rounded-lg">
<p class="text-gray-500">Belum ada data kehadiran</p>
</div>
</div>
</div>
</div>
<!-- Anggota Paling Aktif -->
<div class="bg-white rounded-xl shadow-md p-6">
<h3 class="text-lg font-semibold text-gray-800 mb-4">Anggota Paling Aktif</h3>
<div class="flex items-center justify-center p-8 bg-gray-50 rounded-lg text-gray-500">
                            Belum ada data anggota aktif.
                        </div>
</div>
</div>
<!-- Right Column -->
<div class="space-y-6">
<!-- Calendar -->
<div class="bg-white rounded-xl shadow-md p-6">
<div class="flex justify-between items-center mb-4">
<h3 class="text-lg font-semibold text-gray-800">Kalender Kegiatan</h3>
<div class="flex space-x-2">
<button class="text-blue-500 hover:bg-blue-50 p-1 rounded" id="prev-month">
<svg class="h-5 w-5" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M15 19l-7-7 7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
<button class="text-blue-500 hover:bg-blue-50 p-1 rounded" id="next-month">
<svg class="h-5 w-5" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M9 5l7 7-7 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
</div>
<div class="text-center mb-4">
<h4 class="text-lg font-medium text-gray-700" id="calendar-month-year"></h4>
</div>
<table class="calendar w-full">
<thead>
<tr>
<th>Min</th>
<th>Sen</th>
<th>Sel</th>
<th>Rab</th>
<th>Kam</th>
<th>Jum</th>
<th>Sab</th>
</tr>
</thead>
<tbody id="calendar-body">
<!-- Calendar days will be generated here -->
</tbody>
</table>
</div>
<!-- Kegiatan Mendatang -->
<div class="bg-white rounded-xl shadow-md p-6">
<h3 class="text-lg font-semibold text-gray-800 mb-4">Kegiatan Mendatang</h3>
<div class="space-y-3" id="upcoming-events">
<div class="flex items-center justify-center p-8 bg-gray-50 rounded-lg text-gray-500">
                                Belum ada kegiatan mendatang.
                            </div>
</div>
</div>
<!-- Ilustrasi -->
<div class="bg-gradient-to-br from-blue-400 to-purple-500 rounded-xl shadow-md p-6 text-white">
<h3 class="text-lg font-semibold mb-4">VALUE (NILAI) PELAJAR CHONG DE</h3>
<ul class="text-sm mb-4 list-disc list-inside">
<li><strong>C</strong> = Compassion (Welas Asih)</li>
<li><strong>H</strong> = Harmony (Harmoni)</li>
<li><strong>O</strong> = Open-Mindedness (Keterbukaan Pikiran)</li>
<li><strong>N</strong> = Nobility (Keluhuran Budi)</li>
<li><strong>G</strong> = Growth (Pertumbuhan)</li>
<li><strong>D</strong> = Devotion (Bakti)</li>
<li><strong>E</strong> = Emphaty (Empati)</li>
</ul>
<div class="flex justify-center">
<div class="mt-6 text-center">
<img alt="Logo Chong De Youth" class="hidden max-w-full max-h-full" id="logo-preview"/>
</div>
</div>
<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
<circle cx="9" cy="7" r="4"></circle>
<path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
<path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
</div>
</div>
</div>
</div>
</div>
<!-- Add Attendance Modal -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" id="add-attendance-modal">
<div class="bg-white rounded-xl p-6 max-w-md w-full modal-enter">
<div class="flex justify-between items-center mb-4">
<h3 class="text-lg font-semibold">Tambah Data Kehadiran</h3>
<button class="text-gray-500 hover:text-gray-700" id="close-attendance-modal">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<form class="space-y-4" id="attendance-form">
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="member-name">Nama</label>
<input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="member-name" placeholder="Masukkan nama anggota" required="" type="text"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="vihara-input">Vihara</label>
<input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="vihara-input" placeholder="Masukkan nama vihara" type="text"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="attendance-date">Tanggal</label>
<input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="attendance-date" required="" type="date"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1">Gender</label>
<div class="flex space-x-4">
<div class="flex items-center">
<input checked="" class="hidden gender-radio" id="gender-male" name="gender" type="radio" value="male"/>
<label class="px-4 py-2 border border-gray-300 rounded-lg text-center cursor-pointer hover:bg-gray-50 transition-colors" for="gender-male">
                                Pria
                            </label>
</div>
<div class="flex items-center">
<input class="hidden gender-radio" id="gender-female" name="gender" type="radio" value="female"/>
<label class="px-4 py-2 border border-gray-300 rounded-lg text-center cursor-pointer hover:bg-gray-50 transition-colors" for="gender-female">
                                Wanita
                            </label>
</div>
</div>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
<div class="grid grid-cols-3 gap-3">
<div class="flex items-center">
<input checked="" class="hidden" id="status-present" name="attendance-status" type="radio" value="present"/>
<label class="status-badge status-present w-full text-center cursor-pointer" for="status-present">
                                ‚úÖ Hadir
                            </label>
</div>
<div class="flex items-center">
<input class="hidden" id="status-absent" name="attendance-status" type="radio" value="absent"/>
<label class="status-badge status-absent w-full text-center cursor-pointer" for="status-absent">
                                ‚ùå Tidak Hadir
                            </label>
</div>
<div class="flex items-center">
<input class="hidden" id="status-excused" name="attendance-status" type="radio" value="excused"/>
<label class="status-badge status-excused w-full text-center cursor-pointer" for="status-excused">
                                üìù Izin
                            </label>
</div>
</div>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="notes">Catatan (opsional)</label>
<textarea class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="notes" placeholder="Tambahkan catatan jika diperlukan..." rows="3"></textarea>
</div>
<div class="flex justify-between space-x-3 pt-4">
<button class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300" id="cancel-attendance" type="button">Kembali</button>
<button class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" type="submit">Simpan</button>
</div>
</form>
</div>
</div>
<!-- Filter Modal -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" id="filter-modal">
<div class="bg-white rounded-xl p-6 max-w-md w-full modal-enter">
<div class="flex justify-between items-center mb-4">
<h3 class="text-lg font-semibold">Filter Data</h3>
<button class="text-gray-500 hover:text-gray-700" id="close-filter-modal">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<form class="space-y-4" id="filter-form">
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="filter-date">Tanggal</label>
<input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="filter-date" type="date"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="filter-activity">Aktivitas</label>
<select class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="filter-activity">
<option value="">Semua Aktivitas</option>
<option value="Ngobras">Ngobras</option>
<option value="Aktivitas Outdoor">Aktivitas Outdoor</option>
<option value="Sidang Dharma">Sidang Dharma</option>
<option value="Kelas Dharma">Kelas Dharma</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="filter-vihara">Vihara</label>
<input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="filter-vihara" placeholder="Masukkan nama vihara" type="text"/>
</div>
<div class="flex justify-between space-x-3 pt-4">
<button class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300" id="reset-filter" type="button">Reset</button>
<button class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" type="submit">Terapkan</button>
</div>
</form>
</div>
</div>
<!-- All Members Modal -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" id="all-members-modal">
<div class="bg-white rounded-xl p-6 max-w-4xl w-full max-h-[80vh] overflow-y-auto modal-enter">
<div class="flex justify-between items-center mb-4">
<h3 class="text-lg font-semibold">Daftar Semua Anggota</h3>
<button class="text-gray-500 hover:text-gray-700" id="close-members-modal">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<div class="flex items-center mb-4">
<input class="border border-gray-300 rounded px-3 py-1 w-full md:w-1/3 focus:outline-none" id="search" placeholder="Cari nama..." type="text"/>
<button class="ml-2 px-4 py-1 bg-blue-500 text-white rounded hover:bg-blue-600" id="search-button">
    Cari
  </button>
</div>
<div class="text-red-500 mt-2" id="search-result"></div>
<div class="space-y-2" id="all-members-list">
<!-- Empty state -->
<div class="flex items-center justify-center p-8 bg-gray-50 rounded-lg text-gray-500">
                    Belum ada anggota terdaftar.
                </div>
</div>
</div>
</div>
<!-- Status Filter Modals -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" id="present-members-modal">
<div class="bg-white rounded-xl p-6 max-w-4xl w-full max-h-[80vh] overflow-y-auto modal-enter">
<div class="flex justify-between items-center mb-4">
<h3 class="text-lg font-semibold">Anggota Hadir</h3>
<button class="text-gray-500 hover:text-gray-700" id="close-present-modal">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<div class="space-y-2" id="present-members-list">
<!-- Empty state -->
<div class="flex items-center justify-center p-8 bg-gray-50 rounded-lg text-gray-500">
                    Belum ada anggota yang hadir.
                </div>
</div>
</div>
</div>
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" id="absent-members-modal">
<div class="bg-white rounded-xl p-6 max-w-4xl w-full max-h-[80vh] overflow-y-auto modal-enter">
<div class="flex justify-between items-center mb-4">
<h3 class="text-lg font-semibold">Anggota Tidak Hadir</h3>
<button class="text-gray-500 hover:text-gray-700" id="close-absent-modal">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<div class="space-y-2" id="absent-members-list">
<!-- Empty state -->
<div class="flex items-center justify-center p-8 bg-gray-50 rounded-lg text-gray-500">
                    Belum ada anggota yang tidak hadir.
                </div>
</div>
</div>
</div>
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" id="excused-members-modal">
<div class="bg-white rounded-xl p-6 max-w-4xl w-full max-h-[80vh] overflow-y-auto modal-enter">
<div class="flex justify-between items-center mb-4">
<h3 class="text-lg font-semibold">Anggota Izin</h3>
<button class="text-gray-500 hover:text-gray-700" id="close-excused-modal">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<div class="space-y-2" id="excused-members-list">
<!-- Empty state -->
<div class="flex items-center justify-center p-8 bg-gray-50 rounded-lg text-gray-500">
                    Belum ada anggota yang izin.
                </div>
</div>
</div>
</div>
<!-- Add Event Modal -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" id="add-event-modal">
<div class="bg-white rounded-xl p-6 max-w-md w-full modal-enter">
<div class="flex justify-between items-center mb-4">
<h3 class="text-lg font-semibold">Tambah Kegiatan</h3>
<button class="text-gray-500 hover:text-gray-700" id="close-event-modal">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<form class="space-y-4" id="event-form">
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="event-date">Tanggal</label>
<input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="event-date" readonly="" required="" type="date"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="event-title">Judul Kegiatan</label>
<input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="event-title" placeholder="Masukkan judul kegiatan" required="" type="text"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="event-type">Jenis Kegiatan</label>
<select class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="event-type" required="">
<option disabled="" selected="" value="">Pilih jenis kegiatan</option>
<option value="Ngobras">Ngobras</option>
<option value="Aktivitas Outdoor">Aktivitas Outdoor</option>
<option value="Sidang Dharma">Sidang Dharma</option>
<option value="Kelas Dharma">Kelas Dharma</option>
<option value="Lainnya">Lainnya</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="event-time">Waktu</label>
<input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="event-time" required="" type="time"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="event-location">Lokasi</label>
<input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="event-location" placeholder="Masukkan lokasi kegiatan" type="text"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1" for="event-description">Deskripsi (opsional)</label>
<textarea class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5" id="event-description" placeholder="Tambahkan deskripsi kegiatan..." rows="3"></textarea>
</div>
<div class="flex justify-between space-x-3 pt-4">
<button class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300" id="cancel-event" type="button">Batal</button>
<button class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600" type="submit">Simpan</button>
</div>
</form>
</div>
</div>
<script>
        document.addEventListener('DOMContentLoaded', function() {
    loadAttendanceDataFromStorage();
            // Data storage
            window.attendanceData = [];
            let presentMembers = [];
            let absentMembers = [];
            let excusedMembers = [];
            let currentActivity = '';
            let events = [];
            
            // Navigation between pages
            const goToDashboardBtn = document.getElementById('go-to-dashboard');
            const goToAttendanceBtn = document.getElementById('go-to-attendance');
            const attendancePage = document.getElementById('attendance-page');
            const dashboardPage = document.getElementById('dashboard-page');
            
            goToDashboardBtn.addEventListener('click', function() {
                attendancePage.classList.add('hidden');
                dashboardPage.classList.remove('hidden');
                initializeDashboard();
            });
            
            goToAttendanceBtn.addEventListener('click', function() {
                dashboardPage.classList.add('hidden');
                attendancePage.classList.remove('hidden');
            });
            
            // Logo upload functionality
            const logoContainer = document.getElementById('logo-container');
            const logoPreview = document.getElementById('logo-preview');
            const defaultLogo = document.getElementById('default-logo');
            const dashboardLogoPreview = document.getElementById('dashboard-logo-preview');
            const dashboardDefaultLogo = document.getElementById('dashboard-default-logo');
            
            logoContainer.addEventListener('click', function() {
                // Create file input dynamically
                const fileInput = document.createElement('input');
                fileInput.type = 'file';
                fileInput.accept = 'image/*';
                fileInput.classList.add('file-input');
                
                fileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            // Update both logo previews
                            logoPreview.src = event.target.result;
                            logoPreview.classList.remove('hidden');
                            defaultLogo.classList.add('hidden');
                            
                            dashboardLogoPreview.src = event.target.result;
                            dashboardLogoPreview.classList.remove('hidden');
                            dashboardDefaultLogo.classList.add('hidden');
                            
                            // Store in localStorage
                            localStorage.setItem('chongDeYouthLogo', event.target.result);
                        };
                        reader.readAsDataURL(file);
                    }
                });
                
                fileInput.click();
            });
            
            // Load logo from localStorage if available
            const storedLogo = localStorage.getItem('chongDeYouthLogo');
            if (storedLogo) {
                logoPreview.src = storedLogo;
                logoPreview.classList.remove('hidden');
                defaultLogo.classList.add('hidden');
                
                dashboardLogoPreview.src = storedLogo;
                dashboardLogoPreview.classList.remove('hidden');
                dashboardDefaultLogo.classList.add('hidden');
            }
            
            // Add Attendance Modal
            const addAttendanceBtn = document.getElementById('add-attendance-btn');
            const addAttendanceModal = document.getElementById('add-attendance-modal');
            const closeAttendanceModal = document.getElementById('close-attendance-modal');
            const cancelAttendance = document.getElementById('cancel-attendance');
            const attendanceForm = document.getElementById('attendance-form');
            
            function openAttendanceModal() {
                // Set default date to today
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('attendance-date').value = today;
                
                // Get meeting date from the main form if available
                const meetingDate = document.getElementById('meeting-date').value;
                if (meetingDate) {
                    document.getElementById('attendance-date').value = meetingDate;
                }
                
                addAttendanceModal.classList.remove('hidden');
            }
            
            function closeAttendanceModalFunc() {
                addAttendanceModal.classList.add('hidden');
                attendanceForm.reset();
                
                // Reset gender selection styling
                document.querySelectorAll('input[name="gender"] + label').forEach(label => {
                    label.classList.remove('bg-blue-500', 'text-white');
                });
                document.querySelector('label[for="gender-male"]').classList.add('bg-blue-500', 'text-white');
                
                // Reset status selection styling
                document.querySelectorAll('.status-badge').forEach(badge => {
                    badge.style.transform = 'scale(1)';
                    badge.style.boxShadow = 'none';
                });
            }
            
            addAttendanceBtn.addEventListener('click', openAttendanceModal);
            closeAttendanceModal.addEventListener('click', closeAttendanceModalFunc);
            cancelAttendance.addEventListener('click', closeAttendanceModalFunc);
            
            // Gender selection in modal
            const genderMale = document.getElementById('gender-male');
            const genderFemale = document.getElementById('gender-female');
            
            document.querySelectorAll('input[name="gender"] + label').forEach(label => {
                label.addEventListener('click', function() {
                    const radioId = this.getAttribute('for');
                    document.getElementById(radioId).checked = true;
                    
                    // Remove active class from all labels
                    document.querySelectorAll('input[name="gender"] + label').forEach(l => {
                        l.classList.remove('bg-blue-500', 'text-white');
                    });
                    
                    // Add active class to selected label
                    this.classList.add('bg-blue-500', 'text-white');
                });
            });
            
            // Initialize gender selection
            document.querySelector('label[for="gender-male"]').classList.add('bg-blue-500', 'text-white');
            
            // Status selection in modal
            const statusPresent = document.getElementById('status-present');
            const statusAbsent = document.getElementById('status-absent');
            const statusExcused = document.getElementById('status-excused');
            
            document.querySelectorAll('.status-badge').forEach(badge => {
                badge.addEventListener('click', function() {
                    const radioId = this.getAttribute('for');
                    document.getElementById(radioId).checked = true;
                    
                    // Remove active class from all badges
                    document.querySelectorAll('.status-badge').forEach(b => {
                        b.style.transform = 'scale(1)';
                        b.style.boxShadow = 'none';
                    });
                    
                    // Add active class to selected badge
                    this.style.transform = 'scale(1.05)';
                    this.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';
                });
            });
            
            // Activity select
            const activitySelect = document.getElementById('activity-select');
            activitySelect.addEventListener('change', function() {
                currentActivity = this.value;
                updateActivityDisplay();
            });
            
            function updateActivityDisplay() {
                const activityDisplay = document.getElementById('attendance-activity');
                if (currentActivity) {
                    activityDisplay.textContent = `Aktivitas: ${currentActivity}`;
                } else {
                    activityDisplay.textContent = 'Aktivitas: -';
                }
            }
            
            // Add attendance form submission
            attendanceForm.addEventListener('submit', function(e) {
                e.preventDefault();

                // Get form values
                const name = document.getElementById('member-name').value;
                const vihara = document.getElementById('vihara-input').value;
                const gender = genderMale.checked ? 'Pria' : 'Wanita';
                const attendanceDate = document.getElementById('attendance-date').value;
                const activity = activitySelect.value || '-';
                let status = '';
                let statusClass = '';
                
                if (statusPresent.checked) {
                    status = '‚úÖ Hadir';
                    statusClass = 'status-present';
                } else if (statusAbsent.checked) {
                    status = '‚ùå Tidak Hadir';
                    statusClass = 'status-absent';
                } else if (statusExcused.checked) {
                    status = 'üìù Izin';
                    statusClass = 'status-excused';
                }
                
                const notes = document.getElementById('notes').value;
                
                
                // Create attendance record
                const attendanceRecord = {
                    name: name,
                    vihara: vihara,
                    gender: gender,
                    date: attendanceDate,
                    activity: activity,
                    status: status,
                    statusClass: statusClass,
                    notes: notes
                };
                 kirimKeGoogleSheet(attendanceRecord);
                // Add to appropriate array based on status
                attendanceData.push(attendanceRecord);
                if (statusClass === 'status-present') {
                    presentMembers.push(attendanceRecord);
                } else if (statusClass === 'status-absent') {
                    absentMembers.push(attendanceRecord);
                } else if (statusClass === 'status-excused') {
                    excusedMembers.push(attendanceRecord);
                }
                
                // Update UI
                updateAttendanceTable();
                updateAttendanceCounts();
                
                // Update meeting date in the main form if not already set
                if (!document.getElementById('meeting-date').value) {
                    document.getElementById('meeting-date').value = attendanceDate;
                }
                
                // Update activity in the main form if not already set
                if (!document.getElementById('activity-select').value && activity) {
                    document.getElementById('activity-select').value = activity;
                    currentActivity = activity;
                    updateActivityDisplay();
                }
                
                // Show success message
                const successMessage = document.createElement('div');
                successMessage.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                successMessage.textContent = `Data kehadiran ${name} berhasil disimpan!`;
                document.body.appendChild(successMessage);
                
                setTimeout(() => {
                    successMessage.remove();
                }, 3000);
                
                // Close modal and reset form
                closeAttendanceModalFunc();
            });
            
            // Update attendance table
            function updateAttendanceTable() {
                const attendanceGrid = document.querySelector('.attendance-grid');
                
                // Keep the headers
                const headers = `
    <div class="attendance-header">Daftar Kehadiran</div>
    <div class="attendance-header">Kehadiran</div>
    <div class="attendance-header">Kehadiran</div>
    <div class="attendance-header">Kehadiran</div>
    <div class="attendance-header">Kehadiran</div>
`;
                
                // Clear existing rows
                attendanceGrid.innerHTML = headers;
                
                // Check if there's data
                if (attendanceData.length === 0) {
                    attendanceGrid.innerHTML += `
                        <div class="attendance-row empty-state">
                            <div class="attendance-cell col-span-5 py-8 justify-center text-gray-500">
                                Belum ada data absensi. Klik "Tambah Absensi" untuk menambahkan data.
                            </div>
                        </div>
                    `;
                    return;
                }
                
                // Add rows for each attendance record
                attendanceData.forEach((record, index) => {
                    const initials = record.name.split(' ').map(n => n[0]).join('').toUpperCase();
                    const colorClasses = [
                        'bg-blue-200 text-blue-600',
                        'bg-green-200 text-green-600',
                        'bg-yellow-200 text-yellow-600',
                        'bg-purple-200 text-purple-600',
                        'bg-pink-200 text-pink-600',
                        'bg-indigo-200 text-indigo-600',
                        'bg-orange-200 text-orange-600',
                        'bg-teal-200 text-teal-600'
                    ];
                    const colorClass = colorClasses[index % colorClasses.length];
                    
                    const row = `
                        <div class="attendance-row">
                            <div class="attendance-cell">
                                <div class="w-8 h-8 ${colorClass} rounded-full flex items-center justify-center font-bold mr-3">${initials}</div>
                                <div>
                                    <p class="font-medium">${record.name}</p>
                                    <p class="text-xs text-gray-500">${record.gender}</p>
                                    <div class="attendance-cell justify-center space-x-2">
    
    
</div>
                                </div>
                            </div>
                            <div class="attendance-cell justify-center">
                                <span>${record.vihara || '-'}</span>
                            </div>
                            <div class="attendance-cell justify-center">
                                <span>${formatDate(record.date)}</span>
                            </div>
                            <div class="attendance-cell justify-center">
                                <span class="status-badge ${record.statusClass}">${record.status}</span>
                            </div>
                            <div class="attendance-cell">
                                <span class="text-sm text-gray-600">${record.notes || '-'}</span>
                            </div>
                        </div>
                    `;
                    
                    attendanceGrid.innerHTML += row;
                });
                
                // Update pagination info
                document.querySelector('.text-sm.text-gray-500').textContent = `Menampilkan ${attendanceData.length} anggota`;
                
                // Update attendance date if available
                const meetingDate = document.getElementById('meeting-date').value;
                if (meetingDate) {
                    document.getElementById('attendance-date').textContent = `Tanggal: ${formatDate(meetingDate)}`;
                }
            }
            
            // Format date for display
            function formatDate(dateString) {
                if (!dateString) return '-';
                
                const options = { day: 'numeric', month: 'long', year: 'numeric' };
                const date = new Date(dateString);
                return date.toLocaleDateString('id-ID', options);
            }
            
            // Update attendance counts
            function updateAttendanceCounts() {
                const totalCount = attendanceData.length;
                const presentCount = presentMembers.length;
                const absentCount = absentMembers.length;
                const excusedCount = excusedMembers.length;
                
                // Calculate percentages
                const presentPercentage = totalCount > 0 ? Math.round((presentCount / totalCount) * 100) : 0;
                const absentPercentage = totalCount > 0 ? Math.round((absentCount / totalCount) * 100) : 0;
                const excusedPercentage = totalCount > 0 ? Math.round((excusedCount / totalCount) * 100) : 0;
                
                // Update cards
                document.querySelector('#total-members-card h2').textContent = totalCount;
                document.querySelector('#present-card h2').textContent = presentCount;
                document.querySelector('#present-card p.text-green-100.text-xs').textContent = `${presentPercentage}% dari total anggota`;
                
                document.querySelector('#absent-card h2').textContent = absentCount;
                document.querySelector('#absent-card p.text-red-100.text-xs').textContent = `${absentPercentage}% dari total anggota`;
                
                document.querySelector('#excused-card h2').textContent = excusedCount;
                document.querySelector('#excused-card p.text-yellow-100.text-xs').textContent = `${excusedPercentage}% dari total anggota`;
            }
            
            // Filter Modal
            const closeFilterModal = document.getElementById('close-filter-modal');
            const resetFilter = document.getElementById('reset-filter');
            const filterForm = document.getElementById('filter-form');
            
            if (closeFilterModal) {
                closeFilterModal.addEventListener('click', function() {
                    document.getElementById('filter-modal').classList.add('hidden');
                });
            }
            
            if (resetFilter) {
                resetFilter.addEventListener('click', function() {
                    document.getElementById('filter-date').value = '';
                    document.getElementById('filter-activity').value = '';
                    document.getElementById('filter-vihara').value = '';
                });
            }
            
            if (filterForm) {
                filterForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Get form values
                    const date = document.getElementById('filter-date').value;
                    const activity = document.getElementById('filter-activity').value;
                    const vihara = document.getElementById('filter-vihara').value;
                    
                    // Show success message
                    const successMessage = document.createElement('div');
                    successMessage.className = 'fixed bottom-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                    successMessage.textContent = `Filter diterapkan`;
                    document.body.appendChild(successMessage);
                    
                    setTimeout(() => {
                        successMessage.remove();
                    }, 3000);
                    
                    // Close modal
                    document.getElementById('filter-modal').classList.add('hidden');
                });
            }
            
            // Export button functionality
            const exportBtn = document.getElementById('export-btn');
            
            exportBtn.addEventListener('click', function() {
                const successMessage = document.createElement('div');
                successMessage.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                successMessage.textContent = 'Data absensi berhasil diekspor ke Excel!';
                document.body.appendChild(successMessage);
                
                setTimeout(() => {
                    successMessage.remove();
                }, 3000);
            });
            
            // Search functionality
            
            const searchInput = document.getElementById('search');
            
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                

searchButton.addEventListener('click', function () {
  const keyword = document.getElementById('search').value.toLowerCase();
  const filtered = attendanceData.filter(record =>
    record.name.toLowerCase().includes(keyword) ||
    record.vihara.toLowerCase().includes(keyword) ||
    (record.notes && record.notes.toLowerCase().includes(keyword))
  );
  tampilkanHasilPencarian(filtered);
});
                
                // Filter attendance data
                const filteredData = attendanceData.filter(record => 
                    record.name.toLowerCase().includes(searchTerm) || 
                    (record.vihara && record.vihara.toLowerCase().includes(searchTerm)) ||
                    (record.notes && record.notes.toLowerCase().includes(searchTerm)) ||
                    record.gender.toLowerCase().includes(searchTerm)
                );
                
                // Update table with filtered data
                const attendanceGrid = document.querySelector('.attendance-grid');
                
                // Keep the headers
                const headers = `
                    <div class="attendance-header">Daftar Kehadiran</div>
                    <div class="attendance-header">Kehadiran</div>
                    <div class="attendance-header">Kehadiran</div>
                    <div class="attendance-header">Kehadiran</div>
                    <div class="attendance-header">Kehadiran</div>
                `;
                
                // Clear existing rows
                attendanceGrid.innerHTML = headers;
                
                // Check if there's filtered data
                if (filteredData.length === 0) {
                    attendanceGrid.innerHTML += `
                        <div class="attendance-row empty-state">
                            <div class="attendance-cell col-span-5 py-8 justify-center text-gray-500">
                                Tidak ada hasil yang cocok dengan pencarian "${searchTerm}".
                            </div>
                        </div>
                    `;
                    return;
                }
                
                // Add rows for each filtered record
                filteredData.forEach((record, index) => {
                    const initials = record.name.split(' ').map(n => n[0]).join('').toUpperCase();
                    const colorClasses = [
                        'bg-blue-200 text-blue-600',
                        'bg-green-200 text-green-600',
                        'bg-yellow-200 text-yellow-600',
                        'bg-purple-200 text-purple-600',
                        'bg-pink-200 text-pink-600',
                        'bg-indigo-200 text-indigo-600',
                        'bg-orange-200 text-orange-600',
                        'bg-teal-200 text-teal-600'
                    ];
                    const colorClass = colorClasses[index % colorClasses.length];
                    
                    const row = `
                        <div class="attendance-row">
                            <div class="attendance-cell">
                                <div class="w-8 h-8 ${colorClass} rounded-full flex items-center justify-center font-bold mr-3">${initials}</div>
                                <div>
                                    <p class="font-medium">${record.name}</p>
                                    <p class="text-xs text-gray-500">${record.gender}</p>
                                </div>
                            </div>
                            <div class="attendance-cell justify-center">
                                <span>${record.vihara || '-'}</span>
                            </div>
                            <div class="attendance-cell justify-center">
                                <span>${formatDate(record.date)}</span>
                            </div>
                            <div class="attendance-cell justify-center">
                                <span class="status-badge ${record.statusClass}">${record.status}</span>
                            </div>
                            <div class="attendance-cell">
                                <span class="text-sm text-gray-600">${record.notes || '-'}</span>
                            </div>
                        </div>
                    `;
                    
                    attendanceGrid.innerHTML += row;
                });
                
                // Update pagination info
                document.querySelector('.text-sm.text-gray-500').textContent = `Menampilkan ${filteredData.length} dari ${attendanceData.length} anggota`;
            });
            
            // Status cards click handlers
            const totalMembersCard = document.getElementById('total-members-card');
            const presentCard = document.getElementById('present-card');
            const absentCard = document.getElementById('absent-card');
            const excusedCard = document.getElementById('excused-card');
            
            const allMembersModal = document.getElementById('all-members-modal');
            const presentMembersModal = document.getElementById('present-members-modal');
            const absentMembersModal = document.getElementById('absent-members-modal');
            const excusedMembersModal = document.getElementById('excused-members-modal');
            
            const closeMembersModal = document.getElementById('close-members-modal');
            const closePresentModal = document.getElementById('close-present-modal');
            const closeAbsentModal = document.getElementById('close-absent-modal');
            const closeExcusedModal = document.getElementById('close-excused-modal');
            
            totalMembersCard.addEventListener('click', function() {
                updateMembersModal(allMembersModal, 'all-members-list', attendanceData);
                allMembersModal.classList.remove('hidden');
            });
            
            presentCard.addEventListener('click', function() {
                updateMembersModal(presentMembersModal, 'present-members-list', presentMembers);
                presentMembersModal.classList.remove('hidden');
            });
            
            absentCard.addEventListener('click', function() {
                updateMembersModal(absentMembersModal, 'absent-members-list', absentMembers);
                absentMembersModal.classList.remove('hidden');
            });
            
            excusedCard.addEventListener('click', function() {
                updateMembersModal(excusedMembersModal, 'excused-members-list', excusedMembers);
                excusedMembersModal.classList.remove('hidden');
            });
            
            closeMembersModal.addEventListener('click', function() {
                allMembersModal.classList.add('hidden');
            });
            
            closePresentModal.addEventListener('click', function() {
                presentMembersModal.classList.add('hidden');
            });
            
            closeAbsentModal.addEventListener('click', function() {
                absentMembersModal.classList.add('hidden');
            });
            
            closeExcusedModal.addEventListener('click', function() {
                excusedMembersModal.classList.add('hidden');
            });
            
            function updateMembersModal(modal, listId, members) {
                const membersList = document.getElementById(listId);
                
                // Clear existing content
                membersList.innerHTML = '';
                
                // Check if there are members
                if (members.length === 0) {
                    membersList.innerHTML = `
                        <div class="flex items-center justify-center p-8 bg-gray-50 rounded-lg text-gray-500">
                            Belum ada anggota terdaftar.
                        </div>
                    `;
                    return;
                }
                
                // Add each member to the list
                members.forEach((member, index) => {
                    const initials = member.name.split(' ').map(n => n[0]).join('').toUpperCase();
                    const colorClasses = [
                        'bg-blue-200 text-blue-600',
                        'bg-green-200 text-green-600',
                        'bg-yellow-200 text-yellow-600',
                        'bg-purple-200 text-purple-600',
                        'bg-pink-200 text-pink-600',
                        'bg-indigo-200 text-indigo-600',
                        'bg-orange-200 text-orange-600',
                        'bg-teal-200 text-teal-600'
                    ];
                    const colorClass = colorClasses[index % colorClasses.length];
                    
                    const memberItem = document.createElement('div');
                    memberItem.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg';
                    memberItem.innerHTML = `
                        <div class="flex items-center">
                            <div class="w-10 h-10 ${colorClass} rounded-full flex items-center justify-center font-bold mr-3">${initials}</div>
                            <div>
                                <p class="font-medium">${member.name}</p>
                                <div class="flex space-x-2 text-sm text-gray-500">
                                    <span>${member.gender}</span>
                                    <span>‚Ä¢</span>
                                    <span>${member.vihara || 'Tidak ada vihara'}</span>
                                    <span>‚Ä¢</span>
                                    <span>${formatDate(member.date)}</span>
                                    ${member.activity ? `<span>‚Ä¢</span><span>${member.activity}</span>` : ''}
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <span class="status-badge ${member.statusClass} mr-2">${member.status}</span>
                        </div>
                    `;
                    
                    membersList.appendChild(memberItem);
                });
            }
            
            // Members search functionality
            const membersSearch = document.getElementById('members-search');
            
            if (membersSearch) {
                membersSearch.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    
                    // Filter members
                    const filteredMembers = attendanceData.filter(member => 
                        member.name.toLowerCase().includes(searchTerm) || 
                        (member.vihara && member.vihara.toLowerCase().includes(searchTerm)) ||
                        member.gender.toLowerCase().includes(searchTerm) ||
                        (member.activity && member.activity.toLowerCase().includes(searchTerm))
                    );
                    
                    // Update the modal
                    updateMembersModal(allMembersModal, 'all-members-list', filteredMembers);
                });
            }
            
            // Meeting date change handler
            const meetingDateInput = document.getElementById('meeting-date');
            meetingDateInput.addEventListener('change', function() {
                const date = this.value;
                if (date) {
                    document.getElementById('attendance-date').textContent = `Tanggal: ${formatDate(date)}`;
                } else {
                    document.getElementById('attendance-date').textContent = 'Tanggal: -';
                }
            });
            
            // Calendar functionality
            let currentDate = new Date();
            let selectedDate = null;
            
            // Calendar navigation
            const prevMonthBtn = document.getElementById('prev-month');
            const nextMonthBtn = document.getElementById('next-month');
            
            prevMonthBtn.addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            });
            
            nextMonthBtn.addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            });
            
            // Render calendar
            function renderCalendar() {
                const calendarBody = document.getElementById('calendar-body');
                const monthYearDisplay = document.getElementById('calendar-month-year');
                
                // Clear previous calendar
                calendarBody.innerHTML = '';
                
                // Set month and year display
                const monthNames = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
                monthYearDisplay.textContent = `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
                
                // Get first day of month
                const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
                const startingDay = firstDay.getDay(); // 0 = Sunday, 1 = Monday, etc.
                
                // Get number of days in month
                const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
                const totalDays = lastDay.getDate();
                
                // Get today's date for highlighting
                const today = new Date();
                const isCurrentMonth = today.getMonth() === currentDate.getMonth() && today.getFullYear() === currentDate.getFullYear();
                const todayDate = today.getDate();
                
                // Create calendar rows and cells
                let date = 1;
                let calendarHTML = '';
                
                // Create rows for the calendar (6 rows max)
                for (let i = 0; i < 6; i++) {
                    // Start a new row
                    let row = '<tr>';
                    
                    // Create 7 cells for each day of the week
                    for (let j = 0; j < 7; j++) {
                        if (i === 0 && j < startingDay) {
                            // Empty cells before the first day of the month
                            row += '<td class="other-month"></td>';
                        } else if (date > totalDays) {
                            // Empty cells after the last day of the month
                            row += '<td class="other-month"></td>';
                        } else {
                            // Regular day cells
                            const isToday = isCurrentMonth && date === todayDate;
                            const dateStr = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(date).padStart(2, '0')}`;
                            const hasEvent = events.some(event => event.date === dateStr);
                            
                            let classes = '';
                            if (isToday) classes += 'today ';
                            if (hasEvent) classes += 'has-event ';
                            
                            row += `<td class="${classes}" data-date="${dateStr}">${date}</td>`;
                            date++;
                        }
                    }
                    
                    // Close the row
                    row += '</tr>';
                    
                    // Add row to calendar HTML
                    calendarHTML += row;
                    
                    // If we've displayed all days, break out of the loop
                    if (date > totalDays) {
                        break;
                    }
                }
                
                // Set calendar HTML
                calendarBody.innerHTML = calendarHTML;
                
                // Add click event to calendar cells
                document.querySelectorAll('.calendar td:not(.other-month)').forEach(cell => {
                    cell.addEventListener('click', function() {
                        const dateStr = this.getAttribute('data-date');
                        selectedDate = dateStr;
                        openAddEventModal(dateStr);
                    });
                });
            }
            
            // Add Event Modal
            const addEventModal = document.getElementById('add-event-modal');
            const closeEventModal = document.getElementById('close-event-modal');
            const cancelEvent = document.getElementById('cancel-event');
            const eventForm = document.getElementById('event-form');
            
            function openAddEventModal(dateStr) {
                document.getElementById('event-date').value = dateStr;
                addEventModal.classList.remove('hidden');
            }
            
            function closeAddEventModal() {
                addEventModal.classList.add('hidden');
                eventForm.reset();
            }
            
            closeEventModal.addEventListener('click', closeAddEventModal);
            cancelEvent.addEventListener('click', closeAddEventModal);
            
            // Add event form submission
            eventForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Get form values
                const date = document.getElementById('event-date').value;
                const title = document.getElementById('event-title').value;
                const type = document.getElementById('event-type').value;
                const time = document.getElementById('event-time').value;
                const location = document.getElementById('event-location').value;
                const description = document.getElementById('event-description').value;
                
                // Create event object
                const event = {
                    date: date,
                    title: title,
                    type: type,
                    time: time,
                    location: location,
                    description: description
                };
                
                // Add to events array
                events.push(event);
                
                // Update UI
                renderCalendar();
                updateUpcomingEvents();
                
                // Show success message
                const successMessage = document.createElement('div');
                successMessage.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                successMessage.textContent = `Kegiatan "${title}" berhasil ditambahkan!`;
                document.body.appendChild(successMessage);
                
                setTimeout(() => {
                    successMessage.remove();
                }, 3000);
                
                // Close modal and reset form
                closeAddEventModal();
            });
            
            // Update upcoming events
            function updateUpcomingEvents() {
                const upcomingEventsContainer = document.getElementById('upcoming-events');
                
                // Sort events by date
                const sortedEvents = [...events].sort((a, b) => new Date(a.date) - new Date(b.date));
                
                // Filter future events
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const futureEvents = sortedEvents.filter(event => {
                    const eventDate = new Date(event.date);
                    return eventDate >= today;
                });
                
                // Clear container
                upcomingEventsContainer.innerHTML = '';
                
                // Check if there are upcoming events
                if (futureEvents.length === 0) {
                    upcomingEventsContainer.innerHTML = `
                        <div class="flex items-center justify-center p-8 bg-gray-50 rounded-lg text-gray-500">
                            Belum ada kegiatan mendatang.
                        </div>
                    `;
                    return;
                }
                
                // Add each event to the container
                futureEvents.forEach(event => {
                    const eventDate = new Date(event.date);
                    const formattedDate = eventDate.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });
                    
                    let typeColor = '';
                    switch(event.type) {
                        case 'Ngobras':
                            typeColor = 'bg-blue-100 text-blue-800';
                            break;
                        case 'Aktivitas Outdoor':
                            typeColor = 'bg-green-100 text-green-800';
                            break;
                        case 'Sidang Dharma':
                            typeColor = 'bg-yellow-100 text-yellow-800';
                            break;
                        case 'Kelas Dharma':
                            typeColor = 'bg-purple-100 text-purple-800';
                            break;
                        default:
                            typeColor = 'bg-gray-100 text-gray-800';
                    }
                    
                    const eventElement = document.createElement('div');
                    eventElement.className = 'bg-white border border-gray-200 rounded-lg p-4 shadow-sm';
                    eventElement.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-medium text-gray-900">${event.title}</h4>
                                <p class="text-sm text-gray-500">${formattedDate} ‚Ä¢ ${event.time}</p>
                                ${event.location ? `<p class="text-sm text-gray-500 mt-1">üìç ${event.location}</p>` : ''}
                            </div>
                            <span class="px-2 py-1 text-xs rounded-full ${typeColor}">${event.type}</span>
                        </div>
                        ${event.description ? `<p class="text-sm text-gray-600 mt-2">${event.description}</p>` : ''}
                    `;
                    
                    upcomingEventsContainer.appendChild(eventElement);
                });
            }
            
            // Initialize dashboard
            function initializeDashboard() {
                // Initialize calendar
                renderCalendar();
                
                // Initialize attendance chart
                const ctx = document.getElementById('attendanceChart').getContext('2d');
                
                if (window.attendanceChart) {
                    window.attendanceChart.destroy();
                }
                
                // Calculate attendance percentages
                const totalCount = attendanceData.length;
                const presentCount = presentMembers.length;
                const absentCount = absentMembers.length;
                const excusedCount = excusedMembers.length;
                
                const presentPercentage = totalCount > 0 ? Math.round((presentCount / totalCount) * 100) : 0;
                const absentPercentage = totalCount > 0 ? Math.round((absentCount / totalCount) * 100) : 0;
                const excusedPercentage = totalCount > 0 ? Math.round((excusedCount / totalCount) * 100) : 0;
                
                window.attendanceChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Hadir', 'Tidak Hadir', 'Izin'],
                        datasets: [{
                            data: [presentPercentage, absentPercentage, excusedPercentage],
                            backgroundColor: [
                                '#3b82f6',
                                '#ef4444',
                                '#f59e0b'
                            ],
                            borderWidth: 0,
                            cutout: '70%'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: '#1e40af',
                                titleColor: '#fff',
                                bodyColor: '#fff',
                                padding: 10,
                                displayColors: false,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.parsed}%`;
                                    }
                                }
                            }
                        }
                    }
                });
                
                // Update center text
                document.querySelector('.absolute.inset-0 .text-3xl').textContent = `${presentPercentage}%`;
                
                // Update legend
                document.querySelectorAll('.mt-4.grid span')[0].textContent = `Hadir (${presentPercentage}%)`;
                document.querySelectorAll('.mt-4.grid span')[1].textContent = `Tidak Hadir (${absentPercentage}%)`;
                document.querySelectorAll('.mt-4.grid span')[2].textContent = `Izin (${excusedPercentage}%)`;
                
                // Update upcoming events
                updateUpcomingEvents();
            }
        });
    


// AUTOSAVE: Simpan ke localStorage
function saveAttendanceDataToStorage() {
    localStorage.setItem("attendanceData", JSON.stringify(attendanceData));
}

// AUTOLOAD: Ambil dari localStorage
function loadAttendanceDataFromStorage() {
    const stored = localStorage.getItem("attendanceData");
    if (stored) {
        attendanceData = JSON.parse(stored);
    }
}
</script>
<script>
document.getElementById("export-btn").addEventListener("click", function () {
    if (!attendanceData || attendanceData.length === 0) {
        alert("Belum ada data kehadiran untuk diekspor.");
        return;
    }

    // Format data ke bentuk siap ekspor
    const excelData = attendanceData.map(item => ({
        "Nama": item.name,
        "Vihara": item.vihara || "-",
        "Gender": item.gender,
        "Tanggal": item.date,
        "Status": item.status.replace(/‚úÖ|‚ùå|üìù/, "").trim(),
        "Catatan": item.notes || "-"
    }));

    // Buat dan ekspor file Excel
    const worksheet = XLSX.utils.json_to_sheet(excelData);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, "Absensi");
    XLSX.writeFile(workbook, "absensi-chong-de-youth.xlsx");
    
});

</script>
<script>
const SHEET_API = "https://script.google.com/macros/s/AKfycbwglWW1fJzJsjjjOLL9xMrAXGh4m0KsheYSyqYHFNv8e5-RAHwUpVx7HXWvUkjNMBj3lw/exec";

// Fetch existing data on load
document.addEventListener("DOMContentLoaded", () => {
    fetch(SHEET_API)
        .then(res => res.json())
        .then(data => {
            const tbody = document.getElementById("attendance-body");
            data.forEach(item => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>\${item.name}</td>
                    <td>\${item.vihara}</td>
                    <td>\${item.gender}</td>
                    <td>\${item.date}</td>
                    <td>\${item.activity}</td>
                    <td>\${item.status}</td>
                    <td>\${item.notes}</td>
                `;
                tbody.appendChild(row);
            });
        });
});

// Handle save
document.addEventListener("DOMContentLoaded", function () {
    const saveBtn = document.getElementById("save-btn");
    if (saveBtn) {
        saveBtn.addEventListener("click", function () {
            const data = {
                name: document.getElementById('member-name').value,
                vihara: document.getElementById('vihara-input').value,
                gender: document.querySelector('input[name="gender"]:checked')?.value || '',
                date: document.getElementById('attendance-date').value,
                activity: document.getElementById('activity-select').value,
                status: document.querySelector('input[name="status"]:checked')?.value || '',
                notes: document.getElementById('notes').value
            };

            fetch(SHEET_API, {
                method: "POST",
                body: JSON.stringify(data),
                headers: {
                    "Content-Type": "application/json"
                }
            })
            .then(res => res.json())
            .then(result => {
                if (result.result === "success") {
                    alert("Data berhasil disimpan!");
                    location.reload(); // reload to show updated data
                } else {
                    alert("Gagal menyimpan data.");
                }
            })
            .catch(() => {
                alert("Terjadi kesalahan koneksi.");
            });
        });
    }
});

;

function updateAttendanceCounts() {
    const total = attendanceData.length;
    const hadir = attendanceData.filter(r => r.statusClass === 'status-present').length;
    const tidakHadir = attendanceData.filter(r => r.statusClass === 'status-absent').length;
    const izin = attendanceData.filter(r => r.statusClass === 'status-excused').length;

    document.getElementById('total-members').textContent = total;
    document.getElementById('total-present').textContent = hadir;
    document.getElementById('total-absent').textContent = tidakHadir;
    document.getElementById('total-excused').textContent = izin;
}</script>
<script>
  async function kirimKeGoogleSheet(data) {
    const url = "https://script.google.com/macros/s/AKfycbzcaU9_fExhadWwnGqF7PGsxsT8v9CmJH18Y0XnEGT7_HyL0xtMuGmi8L-VZC8NMP2O-g/exec";
    try {
      const response = await fetch(url, {
        method: "POST",
        mode: "no-cors",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      });
      console.log("Data berhasil dikirim ke Google Sheets");
    } catch (error) {
      console.error("Gagal kirim ke Google Sheets", error);
    }
  }
  let attendanceData = [];

document.addEventListener('DOMContentLoaded', function () {
  const searchInput = document.getElementById('search');
  const searchButton = document.getElementById('search-button');

  if (searchInput) {
    searchInput.addEventListener('input', function () {
      const searchTerm = this.value.toLowerCase();
      const filtered = attendanceData.filter(record =>
        record.name.toLowerCase().includes(searchTerm) ||
        record.vihara.toLowerCase().includes(searchTerm) ||
        (record.notes && record.notes.toLowerCase().includes(searchTerm))
      );
      tampilkanHasilPencarian(filtered);
    });
  }

  if (searchButton) {
    searchButton.addEventListener('click', function () {
      const keyword = searchInput.value.toLowerCase();
      const filtered = attendanceData.filter(record =>
        record.name.toLowerCase().includes(keyword) ||
        record.vihara.toLowerCase().includes(keyword) ||
        (record.notes && record.notes.toLowerCase().includes(keyword))
      );
      tampilkanHasilPencarian(filtered);
    });
  }
});
function tampilkanHasilPencarian(dataArray) {
  const container = document.querySelector('.attendance-grid');
  const notifikasi = document.getElementById('search-result');
  container.innerHTML = '';
  notifikasi.textContent = '';

  if (dataArray.length === 0) {
    notifikasi.textContent = 'üîç Tidak ada data ditemukan.';
    return;
  }

  dataArray.forEach(record => {
    const row = document.createElement('div');
    row.className = 'attendance-row';
    row.innerHTML = `
      <div class="attendance-cell">${record.name}</div>
      <div class="attendance-cell">${record.vihara}</div>
      <div class="attendance-cell">${record.date}</div>
      <div class="attendance-cell">${record.status}</div>
      <div class="attendance-cell">${record.notes || '-'}</div>
    `;
    container.appendChild(row);
  });
}
document.addEventListener('DOMContentLoaded', function () {
  const input = document.getElementById('search');
  const button = document.getElementById('search-button');

  function cariData() {
    const keyword = input.value.toLowerCase();
    const hasil = attendanceData.filter(record =>
      record.name.toLowerCase().includes(keyword)
    );
    tampilkanHasilPencarian(hasil);
  }

  button.addEventListener('click', cariData);

  input.addEventListener('keydown', function (e) {
    if (e.key === 'Enter') {
      cariData();
    }
  });

  // tampilkan semua data awal saat pertama buka
  tampilkanHasilPencarian(attendanceData);
});


  document.querySelectorAll(".delete-button").forEach((btn) => {
    btn.addEventListener("click", function () {
      const index = this.getAttribute("data-index");
      if (index !== null) {
        attendanceData.splice(index, 1);
        tampilkanHasilPencarian(attendanceData);
      }
    });
  });
</script>
<script>
  function hapusData(index) {
    if (confirm("Yakin ingin menghapus data ini?")) {
      attendanceData.splice(index, 1);
      renderAttendance(attendanceData);
    }
  }
</script>
<script>

function tambahData() {
  const name = document.getElementById("nama").value;
  const vihara = document.getElementById("vihara").value;
  const gender = document.getElementById("gender").value;
  const date = document.getElementById("tanggal").value;
  const status = document.getElementById("status").value;
  const notes = document.getElementById("catatan").value;

  const newData = { name, vihara, gender, date, status, notes };
  attendanceData.push(newData);
  tampilkanData();
}

function tampilkanData() {
  const body = document.getElementById("attendance-body");
  if (!body) return;
  body.innerHTML = "";
  attendanceData.forEach((data, index) => {
    const row = document.createElement("div");
    row.className = "grid grid-cols-6 gap-2 border-b p-2 items-center";
    row.innerHTML = `
      <div>${data.name}</div>
      <div>${data.vihara}</div>
      <div>${data.date}</div>
      <div>${data.status}</div>
      <div>${data.notes}</div>
      <div><button onclick="hapusData(${index})" class="bg-red-500 text-white px-2 py-1 rounded">Hapus</button></div>
    `;
    body.appendChild(row);
  });
}

function hapusData(index) {
  attendanceData.splice(index, 1);
  tampilkanData();
}
</script><div class="mt-4 space-y-2" id="attendance-body"></div><script>


function tambahData() {
  const name = document.getElementById("nama").value;
  const vihara = document.getElementById("vihara").value;
  const gender = document.getElementById("gender").value;
  const date = document.getElementById("tanggal").value;
  const status = document.getElementById("status").value;
  const notes = document.getElementById("catatan").value;

  const newData = { name, vihara, gender, date, status, notes };
  attendanceData.push(newData);
  tampilkanData();
}

function tampilkanData() {
  const container = document.getElementById("attendance-body");
  container.innerHTML = "";

  attendanceData.forEach((item, index) => {
    const row = document.createElement("div");
    row.className = "grid grid-cols-6 gap-2 border-b p-2 items-center";
    row.innerHTML = `
      <div>${item.name}</div>
      <div>${item.vihara}</div>
      <div>${item.date}</div>
      <div>${item.status}</div>
      <div>${item.notes}</div>
      <div><button onclick="hapusData(${index})" class="text-red-500 hover:underline">Hapus</button></div>
    `;
    container.appendChild(row);
  });
}

function hapusData(index) {
  if (confirm("Yakin ingin menghapus data ini?")) {
    attendanceData.splice(index, 1);
    tampilkanData();
  }
}
</script><script>


function tambahData() {
  const name = document.getElementById("nama").value;
  const vihara = document.getElementById("vihara").value;
  const gender = document.getElementById("gender").value;
  const date = document.getElementById("tanggal").value;
  const status = document.getElementById("status").value;
  const notes = document.getElementById("catatan").value;

  const newData = { name, vihara, gender, date, status, notes };
  attendanceData.push(newData);
  tampilkanData();

  // Reset input setelah submit
  document.getElementById("nama").value = '';
  document.getElementById("vihara").value = '';
  document.getElementById("gender").value = '';
  document.getElementById("tanggal").value = '';
  document.getElementById("status").value = '';
  document.getElementById("catatan").value = '';
}

function tampilkanData() {
  const container = document.getElementById("attendance-body");
  container.innerHTML = "";

  attendanceData.forEach((item, index) => {
    const row = document.createElement("div");
    row.className = "grid grid-cols-6 gap-2 border-b p-2 items-center";
    row.innerHTML = `
      <div>${item.name}</div>
      <div>${item.vihara}</div>
      <div>${item.date}</div>
      <div>${item.status}</div>
      <div>${item.notes}</div>
      <div><button onclick="hapusData(${index})" class="text-red-500 hover:underline">Hapus</button></div>
    `;
    container.appendChild(row);
  });
}

function hapusData(index) {
  if (confirm("Yakin ingin menghapus data ini?")) {
    attendanceData.splice(index, 1);
    tampilkanData();
  }
}



function tambahBarisKehadiran(data, index) {
  const tbody = document.querySelector("#daftarKehadiran tbody");
  if (!tbody) return;

  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td>${index + 1}</td>
    <td>${data.name || ""}</td>
    <td>${data.vihara || ""}</td>
    <td>${data.gender || ""}</td>
    <td>${data.date || ""}</td>
    <td>${data.status || ""}</td>
    <td>${data.notes || ""}</td>
  `;
  tbody.appendChild(tr);
}

function updateTabelKehadiran() {
  const tbody = document.querySelector("#daftarKehadiran tbody");
  if (!tbody) return;
  tbody.innerHTML = "";
  attendanceData.forEach((data, index) => {
    tambahBarisKehadiran(data, index);
  });
}




function updateTabelKehadiran() {
  const tbody = document.querySelector("#daftarKehadiran tbody");
  if (!tbody) return;
  tbody.innerHTML = "";
  attendanceData.forEach((data, index) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${index + 1}</td>
      <td>${data.name || ""}</td>
      <td>${data.vihara || ""}</td>
      <td>${data.gender || ""}</td>
      <td>${data.date || ""}</td>
      <td>${data.status || ""}</td>
      <td>${data.notes || ""}</td>
      <td><button onclick="hapusData(${index})" class='text-red-500 underline'>Hapus</button></td>
    `;
    tbody.appendChild(tr);
  });
}

function hapusData(index) {
  if (confirm("Yakin ingin menghapus data ini?")) {
    attendanceData.splice(index, 1);
    updateTabelKehadiran();
  }
}

function simpanData() {
  const data = {
    name: document.getElementById("name").value,
    vihara: document.getElementById("vihara").value,
    gender: document.getElementById("gender").value,
    date: document.getElementById("date").value,
    status: document.getElementById("status").value,
    notes: document.getElementById("notes").value
  };
  attendanceData.push(data);
  updateTabelKehadiran();

  document.getElementById("name").value = "";
  document.getElementById("vihara").value = "";
  document.getElementById("gender").value = "";
  document.getElementById("date").value = "";
  document.getElementById("status").value = "";
  document.getElementById("notes").value = "";
}


</script><script>


function updateTabelKehadiran() {
  const tbody = document.querySelector("#daftarKehadiran tbody");
  if (!tbody) return;
  tbody.innerHTML = "";
  attendanceData.forEach((data, index) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${index + 1}</td>
      <td>${data.name || ""}</td>
      <td>${data.vihara || ""}</td>
      <td>${data.gender || ""}</td>
      <td>${data.date || ""}</td>
      <td>${data.status || ""}</td>
      <td>${data.notes || ""}</td>
      <td><button onclick="hapusData(${index})" class='text-red-500 underline'>Hapus</button></td>
    `;
    tbody.appendChild(tr);
  });
}

function hapusData(index) {
  if (confirm("Yakin ingin menghapus data ini?")) {
    attendanceData.splice(index, 1);
    updateTabelKehadiran();
  }
}

function simpanData() {
  const data = {
    name: document.getElementById("name").value,
    vihara: document.getElementById("vihara").value,
    gender: document.getElementById("gender").value,
    date: document.getElementById("date").value,
    status: document.getElementById("status").value,
    notes: document.getElementById("notes").value
  };
  attendanceData.push(data);
  updateTabelKehadiran();

  document.getElementById("name").value = "";
  document.getElementById("vihara").value = "";
  document.getElementById("gender").value = "";
  document.getElementById("date").value = "";
  document.getElementById("status").value = "";
  document.getElementById("notes").value = "";
}

const simpanBtn = document.getElementById("simpan-btn");
if (simpanBtn) simpanBtn.onclick = simpanData;
</script><script>
window.onload = function () {
  const simpanBtn = document.getElementById("simpan-btn");
  if (simpanBtn) simpanBtn.onclick = simpanData;
};
    <script src="https://cdn.tailwindcss.com">
    function hapusData(index) {
        if (confirm("Apakah Anda yakin ingin menghapus data ini?")) {
            attendanceData.splice(index, 1);
            tampilkanHasilPencarian(attendanceData);
        }
    }
    </script>
</script></body>
</html>
